# QNN_DATATYPE_BOOL_8 Support Spec Sheet

This document identifies the functions (operations) and specific parameters in the Qualcomm HTP Operation Definition Supplement that support the `QNN_DATATYPE_BOOL_8` datatype.

## Summary

`QNN_DATATYPE_BOOL_8` is primarily supported in:
- **Logical Operations**: Comparison and bitwise logic.
- **Structural Operations**: Reshaping, slicing, and concatenating boolean tensors.
- **Conditional Operations**: Selection and masking (e.g., `ElementWiseSelect`, `NonZero`).
- **Control Flags**: Specific configuration parameters in complex ops like `Gru` and `Lstm`.

## Supported Operations and Parameters

| Operation Name | Supported Parameter(s) | Notes |
| :--- | :--- | :--- |
| **Buffer** | `in[1]` | |
| **Cast** | `in[0]`, `out[0]` | Supports casting to/from BOOL_8. |
| **Concat** | `in[0..m]`, `out[0]` | |
| **Convert** | `in[0]`, `out[0]` | |
| **CumulativeSum** | `exclusive`, `reverse` | Boolean attributes/flags. |
| **ElementWiseAnd** | `in[0]`, `in[1]`, `out[0]` | |
| **ElementWiseBinary** | `in[0]`, `in[1]`, `out[0]` | Supports sub-ops: EQUAL, GREATER, GREATEREQUAL, LESS, LESSEQUAL, NOTEQUAL, AND, OR, XOR. |
| **ElementWiseEqual** | `out[0]` | Inputs are typically data types, output is boolean. |
| **ElementWiseGreater** | `out[0]` | |
| **ElementWiseGreaterEqual** | `out[0]` | |
| **ElementWiseLess** | `out[0]` | |
| **ElementWiseLessEqual** | `out[0]` | |
| **ElementWiseNot** | `in[0]`, `out[0]` | |
| **ElementWiseNotEqual** | `out[0]` | |
| **ElementWiseOr** | `in[0]`, `in[1]`, `out[0]` | |
| **ElementWiseSelect** | `in[0]` | `in[0]` acts as the condition mask. |
| **ElementWiseUnary** | `in[0]`, `out[0]` | Specifically for the **NOT** sub-operation. |
| **ElementWiseXor** | `in[0]`, `in[1]`, `out[0]` | |
| **Gru** | `in[14]` | Internal state/control parameter. |
| **IsInf** | `out[0]`, `detect_negative`, `detect_positive` | Output and configuration flags. |
| **IsNan** | `out[0]` | |
| **Lstm** | `in[24]` | Internal state/control parameter. |
| **NonZero** | `in[0]` | |
| **Reshape** | `in[0]`, `out[0]` | |
| **RoiAlign** | `aligned`, `allow_invalid_roi` | Boolean attributes. |
| **ScatterNd** | `in[0]`, `in[2]`, `out[0]` | `in[0]` (data) and `in[2]` (updates) can be boolean. |
| **Split** | `in[0]`, `out[0..m]` | |
| **Tile** | `in[0]`, `out[0]` | |
| **Transpose** | `in[0]`, `out[0]` | Supported for 4D. 5D support has limitations. |

## Detailed Notes

- **ElementWiseBinary**: This is a generic operation that can perform various comparisons and logical operations. When used for comparison (e.g., `LESS`), the output is `QNN_DATATYPE_BOOL_8`. When used for logical ops (e.g., `AND`), both inputs and output are `QNN_DATATYPE_BOOL_8`.
- **Structural Ops**: Operations like `Reshape`, `Transpose`, `Split`, `Concat`, and `Tile` are data-agnostic regarding content, allowing them to manipulate the shape of boolean tensors just like numeric tensors.
- **Recurrent Networks**: `Gru` and `Lstm` support `BOOL_8` on specific input indices (`in[14]` and `in[24]` respectively), which likely correspond to specific gate control or initialization flags defined in their detailed schema.
